<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Lesson JSON Extractor</title>
  <style>
    body { font-family: system-ui, sans-serif; padding: 16px; background:#f6f7f9; }
    textarea { width: 100%; min-height: 300px; margin-top: 8px; font-family: monospace; }
    button { margin-top: 8px; padding: 8px 12px; cursor: pointer; }
  </style>
</head>
<body>

<h2>Input JSON</h2>
<textarea id="input" placeholder="Paste curriculum JSON here..."></textarea>
<button id="generateBtn">Generate Output</button>

<h2>Output JSON</h2>
<textarea id="output" readonly></textarea>
<button id="copyBtn">Copy to Clipboard</button>

<script>
  function extractUnits(data) {
    const units = [];

    if (!Array.isArray(data.units)) return { units };

    for (const unit of data.units) {
      const unitObj = {
        unitTitle: unit.title || "",
        lessons: []
      };

      if (Array.isArray(unit.lessons)) {
        for (const lesson of unit.lessons) {
          unitObj.lessons.push({
            lessonTitle: lesson.title || "",
            masteryOutcomes: Array.isArray(lesson.masteryOutcomes)
              ? lesson.masteryOutcomes
              : []
          });
        }
      }

      units.push(unitObj);
    }

    return { units };
  }

  document.getElementById("generateBtn").addEventListener("click", () => {
    try {
      const inputText = document.getElementById("input").value;
      const inputJson = JSON.parse(inputText);

      const outputJson = extractUnits(inputJson);

      document.getElementById("output").value =
        JSON.stringify(outputJson, null, 2);
    } catch (error) {
      alert("Invalid JSON input");
    }
  });

  document.getElementById("copyBtn").addEventListener("click", async () => {
    const output = document.getElementById("output").value;
    if (!output) {
      alert("Nothing to copy");
      return;
    }

    try {
      await navigator.clipboard.writeText(output);
      alert("Copied to clipboard!");
    } catch (error) {
      alert("Copy failed. Please copy manually.");
    }
  });
</script>


</body>
</html>
